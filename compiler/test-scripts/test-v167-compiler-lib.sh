#!/bin/bash
. test-config.sh

# Convert a file using:
# perl -p -e 's/\n/\\n/g' < main.ino | sed 's/\t/\\t/g'
#curl -X POST -H "Accept: application/json" -d '{"files":[{"filename":"Blink Example.ino","content":"\/*\n\tBlink\n\tTurns on an LED on for one second, then off for one second, repeatedly.\n\n\tThis example code is in the public domain.\n*\/\n\nvoid setup()\n{\n\t\/\/ initialize the digital pin as an output.\n\t\/\/ Pin 13 has an LED connected on most Arduino boards:\n\tpinMode(13, OUTPUT);\n}\n\nvoid loop()\n{\n\tdigitalWrite(13, HIGH); \/\/ set the LED on\n\tdelay(1000); \/\/ wait for a second\n\tdigitalWrite(13, LOW); \/\/ set the LED off\n\tdelay(1000); \/\/ wait for a second\n}\n"}],"libraries":[],"logging":true,"format":"binary","version":"167","build":{"mcu":"atmega328p","f_cpu":"16000000L","core":"arduino","platform":"avr","board":"uno","variant":"standard"}}' ${compiler_url}
curl -X POST -H "Accept: application/json" -d '{"pid":17185,"vid":9026,"format":"hex","version":167,"fqbn":"arduino:avr:uno","libraries":{"Morse":[{"content":"/*\n  Morse.cpp - Library for flashing Morse code.\n  Created by David A. Mellis, November 2, 2007.\n  Released into the public domain.\n*/\n\n#include \"Arduino.h\"\n#include \"Morse.h\"\n\nMorse::Morse(int pin)\n{\n  pinMode(pin, OUTPUT);\n  _pin = pin;\n}\n\nvoid Morse::dot()\n{\n  digitalWrite(_pin, HIGH);\n  delay(250);\n  digitalWrite(_pin, LOW);\n  delay(250);\n}\n\nvoid Morse::dash()\n{\n  digitalWrite(_pin, HIGH);\n  delay(1000);\n  digitalWrite(_pin, LOW);\n  delay(250);\n}\n","filename":"Morse.cpp"},{"filename":"Morse.h","content":"/*\n  Morse.h - Library for flashing Morse code.\n  Created by David A. Mellis, November 2, 2007.\n  Released into the public domain.\n*/\n#ifndef Morse_h\n#define Morse_h\n\n#include \"Arduino.h\"\n\nclass Morse\n{\n  public:\n    Morse(int pin);\n    void dot();\n    void dash();\n  private:\n    int _pin;\n};\n\n#endif\n"}]},"logging":1,"files":[{"content":"#include <Morse.h>\n\nMorse morse(13);\n\nvoid setup()\n{\n}\n\nvoid loop()\n{\n  morse.dot(); morse.dot(); morse.dot();\n  morse.dash(); morse.dash(); morse.dash();\n  morse.dot(); morse.dot(); morse.dot();\n  delay(3000);\n}","filename":"main.ino"}]}' ${compiler_url}
